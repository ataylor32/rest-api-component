<!-- Imports polymer -->
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../rest-api/rest-api.html">
<link rel="import" href="./use-rest-behavior.html">

<!-- Defines element markup -->
<dom-module id="rest-query">
</dom-module>

<!-- Registers custom element -->
<script>
Polymer({
  is: 'rest-query',
  properties: {
    data: {
      type: Array,
      notify: true
    }
  },
  behaviors: [UseRest],

  ready: function() {
  },

  attached: function() {
    this.rest = this.getDataSource();
    if (this.rest) {
      this.data = this.rest.data;
      this.rest.request();
      this.rest.addEventListener("data-changed", function() {
        console.log("rest-query: got data", this.rest.data.length);
        this.data = this.rest.data.slice();
      }.bind(this));
      console.log("rest-query: waiting for data from rest", this.rest)
    } else {
      console.error("rest-query: can't get rest element", this.source);
    }
  }
});
</script>
